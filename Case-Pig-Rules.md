
# Case: Pig Rules
**22th June 2024**

## Executive Summary
This report details the process of detecting port scanning activity using Snort and TCPdump. The investigation was conducted to identify and mitigate potential security threats on a network. The approach involved capturing network traffic, filtering relevant data, creating custom Snort rules, and monitoring alerts through Snorby. The outcome was successful identification and classification of port scanning attempts, providing a clear demonstration of the effectiveness of network intrusion detection systems.


---

## Findings and Analysis

### **Network-related findings**
| **Field**               | **Value**               | **Description**                                            |
|:------------------------|:------------------------|:------------------------------------------------------------|
| **Source IP**            | 172.29.0.1              | The source IP from which the port scan originated.           |
| **Destination IP**       | 172.29.0.3              | This was the Targeted IP.                                     |
| **Ports**                | Various Ports.           | The attacker attempts to establish connections on multiple ports. |
| **Attack Type**          | Port Scanning.           | The consistent SYN packets signify a port scanning.            |
| **FLAG: MD5 Hash**       | 1fdcf70d937c1d1796a53fb4fdb9e79c | The completion of challenge flag.                             |
| **TCP SYN Packets**      | Consistent pattern       | Represents connection initiation attempts typical of port scans. |
| **Snort Alert ID**       | 1:1000001:1              | Custom rule created to detect port scans, successfully triggered. |

**Note:** This pattern indicates a port scan, where an attacker is attempting to find open ports on a target machine. The consistent SYN packets signify an attempt to establish connections on multiple ports.


---

## Methodology

### Tools and Technologies Used
**TCPdump:** A command-line packet analyzer used for capturing and filtering network traffic.

- **Reason:** Utilized to capture incoming TCP SYN packets that are indicative of connection attempts and potential port scans.

**Snort:** An open-source network intrusion detection system (NIDS).

- **Reason:** Used to monitor network traffic and generate alerts based on custom rules for identifying suspicious activities.

**Snorby:** *A web-based frontend for Snort.*

- **Reason:** Employed to visualize and classify the alerts generated by Snort.

**nano:** A command-line text editor.

- **Reason:** Used to create and edit Snort rule files for defining custom detection rules.
